<html>
<head>
<title>Release Timeline</title>
	<link rel='stylesheet' href='css/styles.css' type='text/css' />
<!-- 	 <link rel="stylesheet" href="http://codeorigin.jquery.com/ui/1.8.24/themes/dark-hive/jquery-ui.css"> -->
<!-- 	 <link rel="stylesheet" href="http://codeorigin.jquery.com/ui/1.8.24/themes/mint-choc/jquery-ui.css"> -->
 	 <link rel="stylesheet" href="http://codeorigin.jquery.com/ui/1.8.24/themes/ui-darkness/jquery-ui.css">
<!-- 	 <link rel="stylesheet" href="http://codeorigin.jquery.com/ui/1.8.24/themes/vader/jquery-ui.css"> -->
	

	<!-- <script
	src="http://api.simile-widgets.org/timeline/2.3.1/timeline-api.js"
	type="text/javascript"></script>-->
	
	<script language="javascript" type="text/javascript" src="js/projectplan/projectplan.js"></script>
	
	<script>
      Timeline_ajax_url = serviceRoot + "/web/js/simile-ajax-api.js?bundle=true";
      Timeline_urlPrefix = serviceRoot + '/web/js/';       
      Timeline_parameters='bundle=true';
    </script>
    <script src="/ProjectPlan/web/js/timeline-api.js?bundle=true"    
      type="text/javascript">
    </script> 
    
	<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	<script language="javascript" type="text/javascript" src="lib/flot/js/jquery.flot.js"></script>
<!-- 	<script language="javascript" type="text/javascript" src="js/projectplan/burndownChart.js"></script> -->
	<script language="javascript" type="text/javascript" src="js/projectplan/debugConsole.js"></script>
	<script language="javascript" type="text/javascript" src="js/projectplan/typeWriter.js"></script>
	<script language="javascript" type="text/javascript" src="js/projectplan/timelineHandler.js"></script>

<script>

	var tl;
	function refreshTimeline() {
		
		var eventSource = new Timeline.DefaultEventSource();

		var zones = [ {
			start : "Fri Nov 22 1963 00:00:00 GMT-0600",
			end : "Mon Nov 25 1963 00:00:00 GMT-0600",
			magnify : 10,
			unit : Timeline.DateTime.DAY
		}, {
			start : "Fri Nov 22 1963 09:00:00 GMT-0600",
			end : "Sun Nov 24 1963 00:00:00 GMT-0600",
			magnify : 5,
			unit : Timeline.DateTime.HOUR
		}, {
			start : "Fri Nov 22 1963 11:00:00 GMT-0600",
			end : "Sat Nov 23 1963 00:00:00 GMT-0600",
			magnify : 5,
			unit : Timeline.DateTime.MINUTE,
			multiple : 10
		}, {
			start : "Fri Nov 22 1963 12:00:00 GMT-0600",
			end : "Fri Nov 22 1963 14:00:00 GMT-0600",
			magnify : 3,
			unit : Timeline.DateTime.MINUTE,
			multiple : 5
		} ];
		var zones2 = [ {
			start : "Fri Nov 22 1963 00:00:00 GMT-0600",
			end : "Mon Nov 25 1963 00:00:00 GMT-0600",
			magnify : 10,
			unit : Timeline.DateTime.WEEK
		}, {
			start : "Fri Nov 22 1963 09:00:00 GMT-0600",
			end : "Sun Nov 24 1963 00:00:00 GMT-0600",
			magnify : 5,
			unit : Timeline.DateTime.DAY
		}, {
			start : "Fri Nov 22 1963 11:00:00 GMT-0600",
			end : "Sat Nov 23 1963 00:00:00 GMT-0600",
			magnify : 5,
			unit : Timeline.DateTime.MINUTE,
			multiple : 60
		}, {
			start : "Tue June 11 2013 12:00:00 GMT-0600",
			end : "Sun Sept 1 1963 14:00:00 GMT-0600",
			magnify : 10,
			unit : Timeline.DateTime.WEEK,
			multiple : 15
		} ];

		var theme = Timeline.ClassicTheme.create();
		theme.event.bubble.width = 250;

		var date = new Date();
		var bandInfos = [ Timeline.createHotZoneBandInfo({
			width : "80%",
			intervalUnit : Timeline.DateTime.WEEK,
			intervalPixels : 200,
			zones : zones,
			eventSource : eventSource,
			date : date,
			timeZone : -6
		//  theme:          theme
		}), Timeline.createHotZoneBandInfo({
			width : "20%",
			intervalUnit : Timeline.DateTime.MONTH,
			intervalPixels : 200,
			zones : zones2,
			eventSource : eventSource,
			date : date,
			timeZone : -6,
			overview : true
		// theme:          theme
		}) ];
		bandInfos[1].syncWith = 0;
		bandInfos[1].highlight = true;

		for ( var i = 0; i < bandInfos.length; i++) {
			bandInfos[i].decorators = [ 
// 			                            new Timeline.PointHighlightDecorator({
// 				date : "Fri Nov 22 2013 23:59:59 GMT-0600",
// 				color : "#FFC080",
// 				opacity : 50
// 			}), 
			
			new Timeline.PointHighlightDecorator({
				date : new Date(),
				//color : "#FFC080",
				color : "#00FF00",
				opacity : 10
			})];
		}
		
		var workstreamId = $('#workstream').val();
		var description = $('#description').val();
		
		if (description == '') {
			description = '_empty_';
		}
		
		var classes = ['postpone', 'release', 'major_release', 'qa', 'out_of_office', 'phase_deadline', 'prod_defect', 'other'];
		var filterClasses = [];
		for (var i=0; i!=classes.length; i++) {
			if ($('#'+classes[i]).prop('checked')) {
				filterClasses.push(classes[i]);
			}
		}
		var clazz = filterClasses.join(',');
		
		tl = Timeline.create(document.getElementById("tl"), bandInfos,
				Timeline.HORIZONTAL);
		
		var workstreamId = defaultWorkstreamId;
		if ($('#workstream').val() != null) {
			workstreamId = $('#workstream').val();
		}
		
		tl.loadXML(serviceHost + "/timeline/"+workstreamId+
				"/"+description+
				"/"+clazz, function(xml, url) {
			eventSource.loadXML(xml, url);
		});

	}

	var resizeTimerID = null;
	function onResize() {
		if (resizeTimerID == null) {
			resizeTimerID = window.setTimeout(function() {
				resizeTimerID = null;
				tl.layout();
			}, 500);
		}
	}
	
	// Override default event handler (show details) for Timeline
	Timeline.OriginalEventPainter.prototype._showBubble = function(x, y, evt) {
		
		// Get EventID
		var eventId = null;
		for (var i=0; i!=evt._node.attributes.length; i++)
		{
			if (evt._node.attributes[i].name == 'eventId')
			{
				eventId = evt._node.attributes[i].value;
				break;
			}
		}
		
		if (eventId != null)
		{
			loadEventDetails(eventId);	
		}
		else
		{
			resetEventDetails();
			appendWarning('No EventId found for ' + evt.getText());
		}
	}
	

	
</script>
<style type="text/css">

.serviceError {
	color: #FF0000;
}

.serviceSuccess {
	color: #00FF00;
}

.t-highlight1 {
	background-color: #ccf;
}

.p-highlight1 {
	background-color: #fcc;
}

.timeline-highlight-label-start .label_t-highlight1 {
	color: #f00;
}

.timeline-highlight-label-end .label_t-highlight1 {
	color: #aaf;
}

.timeline-band-events .important {
	color: #f00;
}

.timeline-band-events .out_of_office {
	color: #666666;
}

.timeline-band-events .prod_defect {
	color: #FF0000;
}

.timeline-band-events .phase_deadline {
	color: #00ff00;
	font-weight: bold;
}

.timeline-band-events .release {
	color: #00ff00;
}

.timeline-band-events .postpone {
	color: #0008FF;
}

.timeline-band-events .major_release {
	color: #00ff00;
	font-weight: bold;
}

.timeline-band-events .qa {
	color: #ff00ff;
}

.timeline-band-events .small-important {
	background: #c00;
}


/*---------------------------------*/
.dark-theme {
	color: #eee;
}

.dark-theme .timeline-band-0 .timeline-ether-bg {
	background-color: #333
}

.dark-theme .timeline-band-1 .timeline-ether-bg {
	background-color: #111
}

.dark-theme .timeline-band-2 .timeline-ether-bg {
	background-color: #222
}

.dark-theme .timeline-band-3 .timeline-ether-bg {
	background-color: #444
}

.dark-theme .t-highlight1 {
	background-color: #003;
}

.dark-theme .p-highlight1 {
	background-color: #300;
}

.dark-theme .timeline-highlight-label-start .label_t-highlight1 {
	color: #f00;
}

.dark-theme .timeline-highlight-label-end .label_t-highlight1 {
	color: #115;
}

.dark-theme .timeline-band-events .important {
	color: #c00;
}

.dark-theme .timeline-band-events .small-important {
	background: #c00;
}

.dark-theme .timeline-date-label-em {
	color: #fff;
}

.dark-theme .timeline-ether-lines {
	border-color: #555;
	border-style: solid;
}

.dark-theme .timeline-ether-highlight {
	background: #555;
}

.dark-theme .timeline-event-tape,.dark-theme .timeline-small-event-tape
	{
	background: #f60;
}

.dark-theme .timeline-ether-weekends {
	background: #111;
}

.timeline_input {
	background: #222222;
	color: #ffffff;
	border: 0px;
	font-size: 9pt;
	margin: 2px;
	width: 300px;
}

.timeline_textarea {
	background: #222222;
	color: #ffffff;
	border: 0px;
	font-size: 9pt;
	margin: 2px;
	width: 600px;
	height: 70px;
}


.timeline_btn {
	background: #222222;
	color: #ffffff;
	border: 0px;
	font-size: 9pt;
	margin: 2px;
}

fieldset { border:0px solid;
 padding: 1em;
  font:80%/1 sans-serif;
 }

legend {
  padding: 0.2em 0.5em;
  border:0px solid;
  color:green;
  font-size:90%;
  text-align:right;
  }
  
  label {
  float:left;
  width:25%;
  margin: 2px;
  margin-right:10px;
  padding-top:0.2em;
  text-align:right;
  font-weight:bold;
  }
  
</style>

<!-- 	<link href="http://cdn.kendostatic.com/2013.1.514/styles/kendo.common.min.css" rel="stylesheet" /> -->
<!--     <link href="http://cdn.kendostatic.com/2013.1.514/styles/kendo.rtl.min.css" rel="stylesheet" /> -->
<!--     <link href="http://cdn.kendostatic.com/2013.1.514/styles/kendo.default.min.css" rel="stylesheet" /> -->
<!--     <link href="http://cdn.kendostatic.com/2013.1.514/styles/kendo.dataviz.min.css" rel="stylesheet" /> -->
<!--     <link href="http://cdn.kendostatic.com/2013.1.514/styles/kendo.dataviz.default.min.css" rel="stylesheet" /> -->
<!--      <script src="http://cdn.kendostatic.com/2013.1.514/js/kendo.all.min.js"></script> -->
</head>
<body style="margin-left: 0px; margin-right: 0px; margin-top: 0px; background-color: #000000; color: #ffffff;" onload="refreshTimeline();">
	
<!-- 	<script src="js/people.js"></script> -->
	
	<div id="headerContent" style="background-color: #000000; padding: 10px; border-bottom-style: solid; border-bottom: solid 2px #333333;">
<!-- 		<span style="font-size: 24px; color: #ffffff; font-weight: bold;" onClick="window.SimileAjax_onLoad();">Release Timeline</span> -->
	</div>
	
	<!-- <br/>

	<div style="position: relative; left: 100px;">
		<span style="color: #ffffff; font-weight: bold; text-decoration: underline;">Labels:</span>
		<span style="color: #00ff00">Release</span>&nbsp;
		<span style="color: #ff0000">Postpone</span>&nbsp;
		<span style="color: #ffffff">Dev</span>&nbsp;
		<span style="color: #ff00ff">QA</span>&nbsp;
		<span style="color: #666666">Out of Office</span>&nbsp;
	</div>
	<br/> -->	
	<div id="tl" class="timeline-default dark-theme"
			style="height: 380px; margin-top: 0px; margin-bottom: 0px; border-width: 0px;"></div>

	
	 <script>
$(function() {
$( "#tabs" ).tabs();
});
</script>

	<div id="tabs" style="height: 380px;">
		<ul>
			<li><a href="#tabs-1">Search</a></li>
			<li><a href="#tabs-2">Add Event</a></li>
			<li><a href="#tabs-3">Event Details</a></li>
			<li><a href="#tabs-4">Service Console</a></li>
		</ul>
		<div id="tabs-1">
			<fieldset style="width: 500px;">
				
				<label for="stream">Workstream:</label>
				<select class="timeline_input" id="workstream" name="workstream">
				</select>
				<br/>
				
				<label for="description">Description Contains:</label>
				<input type="text" id="description" name="description" class="timeline_input"/>
				<br/>
				
				<label for="class">Classification:</label>
				<div>
					<table>
						<tr>
							<td>
								<input type="checkbox" name="postpone" id="postpone" checked="checked"> Postpone<br/>
								<input type="checkbox" name="release" id="release" checked="checked"> Release<br/>
								<input type="checkbox" name="major_release" id="major_release" checked="checked"> Major Release<br/>
								<input type="checkbox" name="qa" id="qa" checked="checked"> QA<br/>
							</td>
							<td>
								<input type="checkbox" name="out_of_office" id="out_of_office" checked="checked"> Out of Office<br/>
								<input type="checkbox" name="phase_deadline" id="phase_deadline" checked="checked"> Phase Deadline<br/>
								<input type="checkbox" name="prod_defect" id="prod_defect" checked="checked"> Prod Defect<br/>
								<input type="checkbox" name="other" id="other" checked="checked"> Other<br/>
							</td>
						</tr>
					</table>
				</div>
				<br/>
				
				<label for="submit"></label>
				<button name="submit" class="timeline_btn" onClick="refreshTimeline()">Refresh Timeline</button>
				<br/>
			</fieldset>
		</div>
		<div id="tabs-2">
			<form>
				<fieldset>
<!-- 					<div id="eventDetailsPlaceholder" -->
<!-- 						style="width:100%;height:80px; color: #ffffff; margin-right: 20px; "></div> -->
					<table>
						<tr>
							<td align="right" width="100" style="color: #999999;">Workstream Id:</td>
							<td>&nbsp;&nbsp;</td>
							<td>
								<select onchange="displayNewWorkstreamScreen()" class="timeline_input" id="eventDetailsInsPlaceholderWorkstreamId"></select>
							</td>
						</tr>
						<tr id="newWorkstreamScreen">
							<td align="right" width="100" style="color: #999999;"></td>
							<td>&nbsp;&nbsp;</td>
							<td>
								<table>
									<tr>
										<td>Name: </td>
										<td>&nbsp;&nbsp;</td>
										<td><input type="text" class="timeline_input" id="eventDetailsInsWorkstream"/></td>
									</tr>
									<tr>
										<td>Password: </td>
										<td>&nbsp;&nbsp;</td>
										<td><input type="password" class="timeline_input" id="eventDetailsInsWorkstreamPassword"/> &nbsp;<i>Optional: in case you want to make this workstream password-protected</i></td>
									</tr>
								</table>
							</td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Event:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" style="width: 600px;" id="eventDetailsInsPlaceholder"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Start:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" id="eventDetailsInsPlaceholderStart"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">End:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" id="eventDetailsInsPlaceholderEnd"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Classification:</td>
							<td>&nbsp;&nbsp;</td>
							<td>
<!-- 								<input type="text" class="timeline_input" id="eventDetailsInsPlaceholderClass"/> -->
								<select class="timeline_input" id="eventDetailsInsPlaceholderClass">
									<option value="other">Default</option>
									<option value="postpone">Postpone</option>
									<option value="release">Release</option>
									<option value="major_release">Major Release</option>
									<option value="qa">QA</option>
									<option value="out_of_office">Out of Office</option>
									<option value="prod_defect">Prod Defect</option>
								</select>
							</td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Description:</td>
							<td>&nbsp;&nbsp;</td>
							<td><textarea class="timeline_textarea" id="eventDetailsInsPlaceholderDesc"></textarea></td>
						</tr>
						
						<tr>
							<td></td>
							<td>&nbsp;&nbsp;</td>
							<td>
								<span class="serviceError" id="addEvent_errorPlaceholder"></span>
								<span class="serviceSuccess" id="addEvent_successPlaceholder"></span>
							</td>
						</tr>
						<tr height="100">
							<td></td>
							<td>&nbsp;&nbsp;</td>
							<td>
								<button onclick="createNewEvent()">Create</button>
							</td>
						</tr>
					</table>
			
				</fieldset>
			</form>
		</div>
		<div id="tabs-3">
			<form>
				<fieldset>
<!-- 					<div id="eventDetailsPlaceholder" -->
<!-- 						style="width:100%;height:80px; color: #ffffff; margin-right: 20px; "></div> -->
					<input type="hidden" class="timeline_input" id="eventDetailsPlaceholderWorkstreamId" readonly="readonly"/>
					<table>
					    <tr>
							<td align="right" width="100" style="color: #999999;">Event Id:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" style="color: #888888;" class="timeline_input" id="eventDetailsPlaceholderEventId" readonly="readonly"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Event:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" style="width: 600px;" id="eventDetailsPlaceholder"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Start:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" id="eventDetailsPlaceholderStart"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">End:</td>
							<td>&nbsp;&nbsp;</td>
							<td><input type="text" class="timeline_input" id="eventDetailsPlaceholderEnd"/></td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Classification:</td>
							<td>&nbsp;&nbsp;</td>
							<td>
<!-- 								<input type="text" class="timeline_input" id="eventDetailsPlaceholderClass"/> -->
								<select class="timeline_input" id="eventDetailsPlaceholderClass">
									<option value="other">Default</option>
									<option value="postpone">Postpone</option>
									<option value="release">Release</option>
									<option value="major_release">Major Release</option>
									<option value="qa">QA</option>
									<option value="out_of_office">Out of Office</option>
									<option value="prod_defect">Prod Defect</option>
								</select>
							</td>
						</tr>
						<tr>
							<td align="right" width="100" style="color: #999999;">Description:</td>
							<td>&nbsp;&nbsp;</td>
							<td><textarea class="timeline_textarea" id="eventDetailsPlaceholderDesc"></textarea></td>
						</tr>
						
						<tr>
							<td></td>
							<td>&nbsp;&nbsp;</td>
							<td>
								<span class="serviceError" id="eventDetails_errorPlaceholder"></span>
								<span class="serviceSuccess" id="eventDetails_successPlaceholder"></span>
							</td>
						</tr>
						
						<tr height="100">
							<td></td>
							<td>&nbsp;&nbsp;</td>
							<td>
							<button onclick="saveEvent()">Modify</button>&nbsp;&nbsp;&nbsp;
							<button onclick="deleteEvent()">Delete</button>
						</tr>
					</table>
			
				</fieldset>
			</form>
		</div>
		<div id="tabs-4">
			<div id="debugConsolePlaceholder" style="padding: 4px; width: 390px; height: 150px; overflow: hidden; font-size: 7pt;"></div>
		</div>
	</div>
	
	<br/>
	<script type="text/javascript">
	
	$("#newWorkstreamScreen").hide();
	
	 $(function() {
		 $( "button" )
		 .button()
		 .click(function( event ) {
		 event.preventDefault();
		 });
		 });
	 
	 
	appendStatus('Console initialized, using backend at ' + serviceHost);
	
	loadWorkstreams();
	
	</script>
	
	
</body>
</html>
